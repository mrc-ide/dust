<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Iterate Multiple Realisations of Stochastic Models • dust</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Iterate Multiple Realisations of Stochastic Models">
<meta property="og:description" content="An Engine for simulation of stochastic models. Includes support for running stochastic models in parallel, either with shared or varying parameters. Simulations are run efficiently in compiled code and can be run with a fraction of simulated states returned to R, allowing control over memory usage. Support is provided for building bootstrap particle filter for performing Sequential Monte Carlo (e.g., Gordon et al. 1993 &lt;doi:10.1049/ip-f-2.1993.0015&gt;). The core of the simulation engine is the xoshiro256** algorithm (Blackman and Vigna &lt;arXiv:1805.01407&gt;), and the package is further described in FitzJohn et al 2021 &lt;doi:10.12688/wellcomeopenres.16466.2&gt;.">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">dust</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.15.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/dust.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/design.html">Principles and design of dust</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Random numbers</li>
    <li>
      <a href="articles/rng.html">Random number generation</a>
    </li>
    <li>
      <a href="articles/rng_algorithms.html">Algorithms used to compute random numbers</a>
    </li>
    <li>
      <a href="articles/rng_package.html">Using RNGs from packages</a>
    </li>
    <li>
      <a href="articles/rng_distributed.html">Distributed parallel random numbers</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Dive deeper</li>
    <li>
      <a href="articles/data.html">Comparing models and data</a>
    </li>
    <li>
      <a href="articles/gpu.html">Running models on GPUs with CUDA</a>
    </li>
    <li>
      <a href="articles/multi.html">Multiple parameter sets</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mrc-ide/dust/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="dust-">dust <img src="reference/figures/logo.png" align="right" height="139"><a class="anchor" aria-label="anchor" href="#dust-"></a>
</h1></div>
<!-- badges: start -->

<p>Stochastic models appear in many domains as they are easy to write out, but hard to analyse without running many realisations of the process. <code>dust</code> provides an engine for running stochastic models, taking care of many bookkeeping details such as:</p>
<ul>
<li>Running stochastic models in parallel on multi-core machines</li>
<li>Running models massively in parallel on GPU without writing any low-level code</li>
<li>Reducing output by filtering over steps or intermediate outputs</li>
<li>Providing useful verbs for working with stochastic models (for initialisation, state setting, parameter updating, and inspection)</li>
<li>Combining multiple realisations due to stochastic variability and due to different parameter sets</li>
</ul>
<div class="section level2">
<h2 id="get-started">Get started<a class="anchor" aria-label="anchor" href="#get-started"></a>
</h2>
<p>Two vignettes provide an overview of the package, depending on your tastes:</p>
<ul>
<li>
<code><a href="articles/design.html">vignette("design")</a></code> describes the problems <code>dust</code> tries to solve (<a href="https://mrc-ide.github.io/dust/articles/design.html" class="external-link">read on package website</a>)</li>
<li>
<code><a href="articles/dust.html">vignette("dust")</a></code> describes <code>dust</code> by example, showing two simple models and the methods that can drive them (<a href="https://mrc-ide.github.io/dust/articles/dust.html" class="external-link">read on package website</a>)</li>
</ul>
<p>There are further vignettes describing details:</p>
<ul>
<li>
<code><a href="articles/multi.html">vignette("multi")</a></code> on simulating multiple parameter sets at once</li>
<li>
<code><a href="articles/data.html">vignette("data")</a></code> on running a bootstrap particle filter</li>
<li>
<code><a href="articles/gpu.html">vignette("gpu")</a></code> on creating and running models on GPUs</li>
</ul>
<p>And several on the random number generator, around which dust is built:</p>
<ul>
<li>
<code><a href="articles/rng.html">vignette("rng")</a></code> on the parallel random number generator used</li>
<li>
<code><a href="articles/rng_algorithms.html">vignette("rng_algorithms")</a></code> on the details of algorithms used to sample from some distributions</li>
<li>
<code><a href="articles/rng_package.html">vignette("rng_package")</a></code> on using the generators from other packages</li>
</ul>
<p>The C++ API is documented in a separate <a href="cpp">set of documentation</a></p>
<p>You can also read our open access paper describing <code>dust</code> and some related tools that use it:</p>
<blockquote>
<p><a href="https://wellcomeopenresearch.org/articles/5-288/v2" class="external-link">FitzJohn, Knock, Whittles, Perez-Guizman, Bhatia, Guntoro, Watson, Whittaker, Ferguson, Cori, Baguelin, Lees 2021: Reproducible parallel inference and simulation of stochastic state space models using odin, dust, and mcstate, Wellcome Open Research 5, 288</a></p>
</blockquote>
</div>
<div class="section level2">
<h2 id="higher-level">Higher-level<a class="anchor" aria-label="anchor" href="#higher-level"></a>
</h2>
<p>The <code>dust</code> package, while designed to be user-friendly, is lower-level than many users need. The <a href="https://mrc-ide.github.io/odin.dust/" class="external-link"><code>odin.dust</code></a> package provides a way of compiling stochastic <a href="https://mrc-ide.github.io/odin/" class="external-link"><code>odin</code></a> models to work with <code>dust</code>. For example, to create a parallel epidemiological model, one might write simply:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sir</span> <span class="op">&lt;-</span> <span class="fu">odin.dust</span><span class="fu">::</span><span class="fu">odin_dust</span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">S</span> <span class="op">-</span> <span class="va">n_SI</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">I</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">I</span> <span class="op">+</span> <span class="va">n_SI</span> <span class="op">-</span> <span class="va">n_IR</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">R</span> <span class="op">+</span> <span class="va">n_IR</span></span>
<span></span>
<span>  <span class="va">n_IR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">I</span>, <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">beta</span> <span class="op">*</span> <span class="va">I</span> <span class="op">/</span> <span class="op">(</span><span class="va">S</span> <span class="op">+</span> <span class="va">I</span> <span class="op">+</span> <span class="va">R</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">n_SI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">S</span>, <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">gamma</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">initial</span><span class="op">(</span><span class="va">S</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">S_ini</span></span>
<span>  <span class="fu">initial</span><span class="op">(</span><span class="va">I</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">I_ini</span></span>
<span>  <span class="fu">initial</span><span class="op">(</span><span class="va">R</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span>  <span class="va">S_ini</span> <span class="op">&lt;-</span> <span class="fu">user</span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span>
<span>  <span class="va">I_ini</span> <span class="op">&lt;-</span> <span class="fu">user</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu">user</span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span></span>
<span>  <span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fu">user</span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="use-cases">Use-cases<a class="anchor" aria-label="anchor" href="#use-cases"></a>
</h2>
<p>We use <code>dust</code> to power several epidemiological models. Public examples include:</p>
<ul>
<li>
<a href="https://mrc-ide.github.io/sircovid/" class="external-link"><code>sircovid</code></a> - a large model (over 15k states) of COVID-19 in the UK</li>
<li>
<a href="https://mrc-ide.github.io/gonovaxdust/" class="external-link"><code>gonovaxdust</code></a> - a model of gonorrhoea infection with vaccination</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Please install from our <a href="https://mrc-ide.r-universe.dev/" class="external-link">r-universe</a>:</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span></span>
<span>  <span class="st">"dust"</span>,</span>
<span>  repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"https://mrc-ide.r-universe.dev"</span>, <span class="st">"https://cloud.r-project.org"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<p>If you prefer, you can install from GitHub with remotes:</p>
<pre><code><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"mrc-ide/dust"</span><span class="op">)</span></span></code></pre>
<p>You will need a compiler to install dependencies for the package, and to build any models with dust. <code>dust</code> uses <code>pkgbuild</code> to build its shared libraries so use <code><a href="https://pkgbuild.r-lib.org/reference/has_build_tools.html" class="external-link">pkgbuild::check_build_tools()</a></code> to see if your system is ok to use.</p>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>MIT © Imperial College of Science, Technology and Medicine</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/mrc-ide/dust/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/mrc-ide/dust/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing dust</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Rich FitzJohn <br><small class="roles"> Author, maintainer </small>   </li>
<li>Alex Hill <br><small class="roles"> Author </small>   </li>
<li>John Lees <br><small class="roles"> Author </small>   </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.repostatus.org/#wip" class="external-link"><img src="https://www.repostatus.org/badges/latest/wip.svg" alt="Project Status: WIP – Initial development is in progress, but there has not yet been a stable, usable release suitable for the public."></a></li>
<li><a href="https://github.com/mrc-ide/dust/actions" class="external-link"><img src="https://github.com/mrc-ide/dust/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://buildkite.com/mrc-ide/dust" class="external-link"><img src="https://badge.buildkite.com/bf7030c393da3ab92f65c63de87bb301b9657a8a9ac6dfb981.svg" alt="Build status"></a></li>
<li><a href="https://www.codefactor.io/repository/github/mrc-ide/dust" class="external-link"><img src="https://www.codefactor.io/repository/github/mrc-ide/dust/badge" alt="CodeFactor"></a></li>
<li><a href="https://codecov.io/github/mrc-ide/dust?branch=master" class="external-link"><img src="https://codecov.io/github/mrc-ide/dust/coverage.svg?branch=master" alt="codecov.io"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Rich FitzJohn, Alex Hill, John Lees.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
