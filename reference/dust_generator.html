<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>The dust class — dust_generator • dust</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="The dust class — dust_generator"><meta property="og:description" content='All "dust" dust models are R6 objects and expose a
common set of "methods".  To create a dust model of your own,
see dust and to interact with some built-in ones see
dust_example()'><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dust</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.15.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/dust.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/design.html">Principles and design of dust</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Random numbers</li>
    <li>
      <a href="../articles/rng.html">Random number generation</a>
    </li>
    <li>
      <a href="../articles/rng_algorithms.html">Algorithms used to compute random numbers</a>
    </li>
    <li>
      <a href="../articles/rng_package.html">Using RNGs from packages</a>
    </li>
    <li>
      <a href="../articles/rng_distributed.html">Distributed parallel random numbers</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Dive deeper</li>
    <li>
      <a href="../articles/data.html">Comparing models and data</a>
    </li>
    <li>
      <a href="../articles/gpu.html">Running models on GPUs with CUDA</a>
    </li>
    <li>
      <a href="../articles/multi.html">Multiple parameter sets</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mrc-ide/dust/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>The dust class</h1>
    <small class="dont-index">Source: <a href="https://github.com/mrc-ide/dust/blob/master/R/dust_generator.R" class="external-link"><code>R/dust_generator.R</code></a></small>
    <div class="hidden name"><code>dust_generator.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>All "dust" dust models are <a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6</a> objects and expose a
common set of "methods".  To create a dust model of your own,
see <a href="dust.html">dust</a> and to interact with some built-in ones see
<code><a href="dust_example.html">dust_example()</a></code></p>
    </div>


    <div id="value">
    <h2>Value</h2>
    <p>A <code>dust_generator</code> object</p>
    </div>
    <div id="time">
    <h2>Time</h2>



<p>For discrete time models, dust has an internal "time", which was
called <code>step</code> in version <code>0.11.x</code> and below.  This must always
be non-negative (i.e., zero or more) and always increases in
unit increments.  Typically a model will remap this internal
time onto a more meaningful time in model space, e.g. by applying
the transform <code>model_time = offset + time * dt</code>; with this approach
you can start at any real valued time and scale the unit increments
to control the model dynamics.</p>
    </div>
    <div id="methods">
    <h2>Methods</h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-dust-new"><code>dust_generator$new()</code></a></p></li>
<li><p><a href="#method-dust-name"><code>dust_generator$name()</code></a></p></li>
<li><p><a href="#method-dust-param"><code>dust_generator$param()</code></a></p></li>
<li><p><a href="#method-dust-run"><code>dust_generator$run()</code></a></p></li>
<li><p><a href="#method-dust-simulate"><code>dust_generator$simulate()</code></a></p></li>
<li><p><a href="#method-dust-run_adjoint"><code>dust_generator$run_adjoint()</code></a></p></li>
<li><p><a href="#method-dust-set_index"><code>dust_generator$set_index()</code></a></p></li>
<li><p><a href="#method-dust-index"><code>dust_generator$index()</code></a></p></li>
<li><p><a href="#method-dust-ode_control"><code>dust_generator$ode_control()</code></a></p></li>
<li><p><a href="#method-dust-ode_statistics"><code>dust_generator$ode_statistics()</code></a></p></li>
<li><p><a href="#method-dust-n_threads"><code>dust_generator$n_threads()</code></a></p></li>
<li><p><a href="#method-dust-n_state"><code>dust_generator$n_state()</code></a></p></li>
<li><p><a href="#method-dust-n_particles"><code>dust_generator$n_particles()</code></a></p></li>
<li><p><a href="#method-dust-n_particles_each"><code>dust_generator$n_particles_each()</code></a></p></li>
<li><p><a href="#method-dust-shape"><code>dust_generator$shape()</code></a></p></li>
<li><p><a href="#method-dust-update_state"><code>dust_generator$update_state()</code></a></p></li>
<li><p><a href="#method-dust-state"><code>dust_generator$state()</code></a></p></li>
<li><p><a href="#method-dust-time"><code>dust_generator$time()</code></a></p></li>
<li><p><a href="#method-dust-set_stochastic_schedule"><code>dust_generator$set_stochastic_schedule()</code></a></p></li>
<li><p><a href="#method-dust-reorder"><code>dust_generator$reorder()</code></a></p></li>
<li><p><a href="#method-dust-resample"><code>dust_generator$resample()</code></a></p></li>
<li><p><a href="#method-dust-info"><code>dust_generator$info()</code></a></p></li>
<li><p><a href="#method-dust-pars"><code>dust_generator$pars()</code></a></p></li>
<li><p><a href="#method-dust-rng_state"><code>dust_generator$rng_state()</code></a></p></li>
<li><p><a href="#method-dust-set_rng_state"><code>dust_generator$set_rng_state()</code></a></p></li>
<li><p><a href="#method-dust-has_openmp"><code>dust_generator$has_openmp()</code></a></p></li>
<li><p><a href="#method-dust-has_gpu_support"><code>dust_generator$has_gpu_support()</code></a></p></li>
<li><p><a href="#method-dust-has_compare"><code>dust_generator$has_compare()</code></a></p></li>
<li><p><a href="#method-dust-real_size"><code>dust_generator$real_size()</code></a></p></li>
<li><p><a href="#method-dust-time_type"><code>dust_generator$time_type()</code></a></p></li>
<li><p><a href="#method-dust-rng_algorithm"><code>dust_generator$rng_algorithm()</code></a></p></li>
<li><p><a href="#method-dust-uses_gpu"><code>dust_generator$uses_gpu()</code></a></p></li>
<li><p><a href="#method-dust-n_pars"><code>dust_generator$n_pars()</code></a></p></li>
<li><p><a href="#method-dust-set_n_threads"><code>dust_generator$set_n_threads()</code></a></p></li>
<li><p><a href="#method-dust-set_data"><code>dust_generator$set_data()</code></a></p></li>
<li><p><a href="#method-dust-compare_data"><code>dust_generator$compare_data()</code></a></p></li>
<li><p><a href="#method-dust-filter"><code>dust_generator$filter()</code></a></p></li>
<li><p><a href="#method-dust-gpu_info"><code>dust_generator$gpu_info()</code></a></p></li>
</ul></div><p></p><hr><a id="method-dust-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Create a new model. Note that the behaviour of this object
created by this function will change considerably based on
whether the <code>pars_multi</code> argument is <code>TRUE</code>. If not (the
default) then we create <code>n_particles</code> which all share the same
parameters as specified by the <code>pars</code> argument. If <code>pars_multi</code>
is <code>TRUE</code> then <code>pars</code> must be an unnamed list, and each element
of it represents a different set of parameters. We will
create <code>length(pars)</code> <em>sets</em> of <code>n_particles</code> particles which
will be simulated together. These particles must have the same
dimension - that is, they must correspond to model state that
is the same size.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/dust_generator.html">dust_generator</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="va">pars</span>,</span>
<span>  <span class="va">time</span>,</span>
<span>  <span class="va">n_particles</span>,</span>
<span>  n_threads <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pars_multi <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  deterministic <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  gpu_config <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ode_control <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>pars</code></dt>
<dd><p>Data to initialise your model with; a <code>list</code>
object, but the required elements will depend on the details of
your model. If <code>pars_multi</code> is <code>TRUE</code>, then this must be an
<em>unnamed</em> list of <code>pars</code> objects (see Details).</p></dd>


<dt><code>time</code></dt>
<dd><p>Initial time - must be nonnegative</p></dd>


<dt><code>n_particles</code></dt>
<dd><p>Number of particles to create - must be at
least 1</p></dd>


<dt><code>n_threads</code></dt>
<dd><p>Number of OMP threads to use, if <code>dust</code> and
your model were compiled with OMP support (details to come).
<code>n_particles</code> should be a multiple of <code>n_threads</code> (e.g., if you use 8
threads, then you should have 8, 16, 24, etc particles). However, this
is not compulsory.</p></dd>


<dt><code>seed</code></dt>
<dd><p>The seed to use for the random number generator. Can
be a positive integer, <code>NULL</code> (initialise with R's random number
generator) or a <code>raw</code> vector of a length that is a multiple of
32 to directly initialise the generator (e..g., from the
<code><a href="dust.html">dust</a></code> object's <code>$rng_state()</code> method).</p></dd>


<dt><code>pars_multi</code></dt>
<dd><p>Logical, indicating if <code>pars</code> should be
interpreted as a set of different initialisations, and that we
should prepare <code>n_particles * length(pars)</code> particles for
simulation. This has an effect on many of the other methods of
the object.</p></dd>


<dt><code>deterministic</code></dt>
<dd><p>Run random number generation deterministically,
replacing a random number from some distribution with its
expectation. Deterministic models are not compatible with running on
a a GPU.</p></dd>


<dt><code>gpu_config</code></dt>
<dd><p>GPU configuration, typically an integer
indicating the device to use, where the model has GPU support.
If not given, then the default value of <code>NULL</code> will fall back on the
first found device if any are available. An error is thrown if the
device id given is larger than those reported to be available (note
that CUDA numbers devices from 0, so that '0' is the first device,
and so on). See the method <code>$gpu_info()</code> for available device ids;
this can be called before object creation as
<code>dust_generator$public_methods$gpu_info()</code>.
For additional control, provide a list with elements <code>device_id</code>
and <code>run_block_size</code>. Further options (and validation) of this
list will be added in a future version!</p></dd>


<dt><code>ode_control</code></dt>
<dd><p>For ODE models, control over the integration;
must be a <code>dust_ode_control</code> model, produced by
<code><a href="dust_ode_control.html">dust_ode_control()</a></code>. It is an error to provide a non-<code>NULL</code>
value for discrete time models.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-dust-name"></a><div class="section">
<h3 id="method-name-">Method <code>name()</code><a class="anchor" aria-label="anchor" href="#method-name-"></a></h3>
<p>Returns friendly model name</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">name</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-dust-param"></a><div class="section">
<h3 id="method-param-">Method <code>param()</code><a class="anchor" aria-label="anchor" href="#method-param-"></a></h3>
<p>Returns parameter information, if provided by the model. This
describes the contents of pars passed to the constructor or to
<code>$update_state()</code> as the <code>pars</code> argument, and the details depend
on the model.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">param</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-dust-run"></a><div class="section">
<h3 id="method-run-">Method <code>run()</code><a class="anchor" aria-label="anchor" href="#method-run-"></a></h3>
<p>Run the model up to a point in time, returning the filtered state
at that point.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="va">time_end</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>time_end</code></dt>
<dd><p>Time to run to (if less than or equal to the current
time(), silently nothing will happen)</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-dust-simulate"></a><div class="section">
<h3 id="method-simulate-">Method <code><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate()</a></code><a class="anchor" aria-label="anchor" href="#method-simulate-"></a></h3>
<p>Iterate all particles forward in time over a series of times,
collecting output as they go. This is a helper around <code>$run()</code>
where you want to run to a series of points in time and save
output. The returned object will be filtered by your active index,
so that it has shape (<code>n_state</code> x <code>n_particles</code> x <code>length(time_end)</code>)
for single-parameter objects, and (<code>n_state</code> x <code>n_particles</code> x
<code>n_pars</code> x <code>length(time_end)</code>) for multiparameter objects. Note that
this method is very similar to <code>$run()</code> except that the rank of
the returned array is one less. For a scalar <code>time_end</code> you would
ordinarily want to use <code>$run()</code> but the resulting numbers would
be identical.</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">simulate</span><span class="op">(</span><span class="va">time_end</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>time_end</code></dt>
<dd><p>A vector of time points that the simulation should
report output at. This the first time must be at least the same
as the current time, and every subsequent time must be equal or
greater than those before it (ties are allowed though probably
not wanted).</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-dust-run_adjoint"></a><div class="section">
<h3 id="method-run-adjoint-">Method <code>run_adjoint()</code><a class="anchor" aria-label="anchor" href="#method-run-adjoint-"></a></h3>
<p>Run model with gradient information (if supported). The
interface here will change, and documentation written once it
stabilises.</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">run_adjoint</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-dust-set_index"></a><div class="section">
<h3 id="method-set-index-">Method <code>set_index()</code><a class="anchor" aria-label="anchor" href="#method-set-index-"></a></h3>
<p>Set the "index" vector that is used to return a subset of pars
after using <code>run()</code>. If this is not used then <code>run()</code> returns
all elements in your state vector, which may be excessive and slower
than necessary.</p><div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">set_index</span><span class="op">(</span><span class="va">index</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>index</code></dt>
<dd><p>The index vector - must be an integer vector with
elements between 1 and the length of the state (this will be
validated, and an error thrown if an invalid index is given).</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-dust-index"></a><div class="section">
<h3 id="method-index-">Method <code>index()</code><a class="anchor" aria-label="anchor" href="#method-index-"></a></h3>
<p>Returns the <code>index</code> as set by <code>$set_index</code></p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">index</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-dust-ode_control"></a><div class="section">
<h3 id="method-ode-control-">Method <code>ode_control()</code><a class="anchor" aria-label="anchor" href="#method-ode-control-"></a></h3>
<p>Return the ODE control set into the object on creation.
For discrete-time models this always returns <code>NULL</code>.</p><div class="section">
<h4 id="usage-8">Usage<a class="anchor" aria-label="anchor" href="#usage-8"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">ode_control</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-dust-ode_statistics"></a><div class="section">
<h3 id="method-ode-statistics-">Method <code>ode_statistics()</code><a class="anchor" aria-label="anchor" href="#method-ode-statistics-"></a></h3>
<p>Return statistics about the integration, for ODE models.
For discrete time models this makes little sense and so errors
if used.</p><div class="section">
<h4 id="usage-9">Usage<a class="anchor" aria-label="anchor" href="#usage-9"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">ode_statistics</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-dust-n_threads"></a><div class="section">
<h3 id="method-n-threads-">Method <code>n_threads()</code><a class="anchor" aria-label="anchor" href="#method-n-threads-"></a></h3>
<p>Returns the number of threads that the model was constructed with</p><div class="section">
<h4 id="usage-10">Usage<a class="anchor" aria-label="anchor" href="#usage-10"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">n_threads</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-dust-n_state"></a><div class="section">
<h3 id="method-n-state-">Method <code>n_state()</code><a class="anchor" aria-label="anchor" href="#method-n-state-"></a></h3>
<p>Returns the length of the per-particle state</p><div class="section">
<h4 id="usage-11">Usage<a class="anchor" aria-label="anchor" href="#usage-11"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">n_state</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-dust-n_particles"></a><div class="section">
<h3 id="method-n-particles-">Method <code>n_particles()</code><a class="anchor" aria-label="anchor" href="#method-n-particles-"></a></h3>
<p>Returns the number of particles</p><div class="section">
<h4 id="usage-12">Usage<a class="anchor" aria-label="anchor" href="#usage-12"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">n_particles</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-dust-n_particles_each"></a><div class="section">
<h3 id="method-n-particles-each-">Method <code>n_particles_each()</code><a class="anchor" aria-label="anchor" href="#method-n-particles-each-"></a></h3>
<p>Returns the number of particles per parameter set</p><div class="section">
<h4 id="usage-13">Usage<a class="anchor" aria-label="anchor" href="#usage-13"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">n_particles_each</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-dust-shape"></a><div class="section">
<h3 id="method-shape-">Method <code>shape()</code><a class="anchor" aria-label="anchor" href="#method-shape-"></a></h3>
<p>Returns the shape of the particles</p><div class="section">
<h4 id="usage-14">Usage<a class="anchor" aria-label="anchor" href="#usage-14"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">shape</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-dust-update_state"></a><div class="section">
<h3 id="method-update-state-">Method <code>update_state()</code><a class="anchor" aria-label="anchor" href="#method-update-state-"></a></h3>
<p>Update one or more components of the model state.
This method can be used to update any or all of <code>pars</code>, <code>state</code> and
<code>time</code>.  If both <code>pars</code> and <code>time</code> are given and <code>state</code> is not,
then by default we will update the model internal state according
to your model's initial conditions - use <code>set_initial_state = FALSE</code>
to prevent this.</p><div class="section">
<h4 id="usage-15">Usage<a class="anchor" aria-label="anchor" href="#usage-15"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">update_state</span><span class="op">(</span></span>
<span>  pars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  state <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  time <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  set_initial_state <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  index <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  reset_step_size <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>pars</code></dt>
<dd><p>New pars for the model (see constructor)</p></dd>


<dt><code>state</code></dt>
<dd><p>The state vector - can be either a numeric vector with the
same length as the model's current state (in which case the same
state is applied to all particles), or a numeric matrix with as
many rows as your model's state and as many columns as you have
particles (in which case you can set a number of different starting
states at once).</p></dd>


<dt><code>time</code></dt>
<dd><p>New initial time for the model. If this
is a vector (with the same length as the number of particles), then
particles are started from different initial times and run up to the
largest time given (i.e., <code>max(time)</code>)</p></dd>


<dt><code>set_initial_state</code></dt>
<dd><p>Control if the model initial state
should be set while setting parameters. It is an error for
this to be <code>TRUE</code> when either <code>pars</code> is <code>NULL</code> or when <code>state</code>
is non-<code>NULL</code>.</p></dd>


<dt><code>index</code></dt>
<dd><p>Used in conjunction with <code>state</code>, use this to set a
fraction of the model state; the <code>index</code> vector provided must
be the same length as the number of provided states, and
indicates the index within the model state that should be updated.
For example, if your model has states <code>[a, b, c, d]</code> and
you provide an index of <code>[1, 3]</code> then of <code>state</code> was <code>[10, 20]</code>
you would set <code>a</code> to 10 and <code>c</code> to 20.</p></dd>


<dt><code>reset_step_size</code></dt>
<dd><p>Logical, indicating if we should
reset the initial step size. This only has an effect with
ode models and is silently ignored in discrete time models
where the step size is constant.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-dust-state"></a><div class="section">
<h3 id="method-state-">Method <code>state()</code><a class="anchor" aria-label="anchor" href="#method-state-"></a></h3>
<p>Return full model state</p><div class="section">
<h4 id="usage-16">Usage<a class="anchor" aria-label="anchor" href="#usage-16"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">state</span><span class="op">(</span>index <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-5">Arguments<a class="anchor" aria-label="anchor" href="#arguments-5"></a></h4>
<p></p><div class="arguments"><dl><dt><code>index</code></dt>
<dd><p>Optional index to select state using</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-dust-time"></a><div class="section">
<h3 id="method-time-">Method <code><a href="https://rdrr.io/r/stats/time.html" class="external-link">time()</a></code><a class="anchor" aria-label="anchor" href="#method-time-"></a></h3>
<p>Return current model time
For ODE models, sets the schedule at which stochastic events are
handled. The timing here is quite subtle - an event happens
immediately <em>after</em> the time (so at <code>time + eps</code>). If your model
runs up to <code>time</code> an event is not triggered, but as soon as that
time is passed, by any amount of time, the event will trigger. It
is an error to set this to a non-<code>NULL</code> value in a discrete time
model; later we may generalise the approach here.</p><div class="section">
<h4 id="usage-17">Usage<a class="anchor" aria-label="anchor" href="#usage-17"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">time</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-dust-set_stochastic_schedule"></a><div class="section">
<h3 id="method-set-stochastic-schedule-">Method <code>set_stochastic_schedule()</code><a class="anchor" aria-label="anchor" href="#method-set-stochastic-schedule-"></a></h3>

<div class="section">
<h4 id="usage-18">Usage<a class="anchor" aria-label="anchor" href="#usage-18"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">set_stochastic_schedule</span><span class="op">(</span><span class="va">time</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-6">Arguments<a class="anchor" aria-label="anchor" href="#arguments-6"></a></h4>
<p></p><div class="arguments"><dl><dt><code>time</code></dt>
<dd><p>A vector of times to run the stochastic update at</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-dust-reorder"></a><div class="section">
<h3 id="method-reorder-">Method <code><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder()</a></code><a class="anchor" aria-label="anchor" href="#method-reorder-"></a></h3>
<p>Reorder particles.</p><div class="section">
<h4 id="usage-19">Usage<a class="anchor" aria-label="anchor" href="#usage-19"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">reorder</span><span class="op">(</span><span class="va">index</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-7">Arguments<a class="anchor" aria-label="anchor" href="#arguments-7"></a></h4>
<p></p><div class="arguments"><dl><dt><code>index</code></dt>
<dd><p>An integer vector, with values between 1 and n_particles,
indicating the index of the current particles that new particles should
take.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-dust-resample"></a><div class="section">
<h3 id="method-resample-">Method <code>resample()</code><a class="anchor" aria-label="anchor" href="#method-resample-"></a></h3>
<p>Resample particles according to some weight.</p><div class="section">
<h4 id="usage-20">Usage<a class="anchor" aria-label="anchor" href="#usage-20"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">resample</span><span class="op">(</span><span class="va">weights</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-8">Arguments<a class="anchor" aria-label="anchor" href="#arguments-8"></a></h4>
<p></p><div class="arguments"><dl><dt><code>weights</code></dt>
<dd><p>A numeric vector representing particle weights.
For a "multi-parameter" dust object this should be be a matrix
with the number of rows being the number of particles per
parameter set and the number of columns being the number of
parameter sets.
long as all particles or be a matrix.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-dust-info"></a><div class="section">
<h3 id="method-info-">Method <code>info()</code><a class="anchor" aria-label="anchor" href="#method-info-"></a></h3>
<p>Returns information about the pars that your model was created with.
Only returns non-NULL if the model provides a <code>dust_info</code> template
specialisation.</p><div class="section">
<h4 id="usage-21">Usage<a class="anchor" aria-label="anchor" href="#usage-21"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">info</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-dust-pars"></a><div class="section">
<h3 id="method-pars-">Method <code>pars()</code><a class="anchor" aria-label="anchor" href="#method-pars-"></a></h3>
<p>Returns the <code>pars</code> object that your model was constructed with.</p><div class="section">
<h4 id="usage-22">Usage<a class="anchor" aria-label="anchor" href="#usage-22"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">pars</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-dust-rng_state"></a><div class="section">
<h3 id="method-rng-state-">Method <code>rng_state()</code><a class="anchor" aria-label="anchor" href="#method-rng-state-"></a></h3>
<p>Returns the state of the random number generator. This returns a
raw vector of length 32 * n_particles. This can be useful for
debugging or for initialising other dust objects. The arguments
<code>first_only</code> and <code>last_only</code> are mutually exclusive. If neither is
given then all all particles states are returned, being 32 bytes
per particle. The full returned state or <code>first_only</code> are most
suitable for reseeding a new dust object.</p><div class="section">
<h4 id="usage-23">Usage<a class="anchor" aria-label="anchor" href="#usage-23"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">rng_state</span><span class="op">(</span>first_only <span class="op">=</span> <span class="cn">FALSE</span>, last_only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-9">Arguments<a class="anchor" aria-label="anchor" href="#arguments-9"></a></h4>
<p></p><div class="arguments"><dl><dt><code>first_only</code></dt>
<dd><p>Logical, indicating if we should return only the
first random number state</p></dd>


<dt><code>last_only</code></dt>
<dd><p>Logical, indicating if we should return only the
<em>last</em> random number state, which does not belong to a particle.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-dust-set_rng_state"></a><div class="section">
<h3 id="method-set-rng-state-">Method <code>set_rng_state()</code><a class="anchor" aria-label="anchor" href="#method-set-rng-state-"></a></h3>
<p>Set the random number state for this model. This
replaces the RNG state that the model is using with a state of
your choosing, saved out from a different model object. This method
is designed to support advanced use cases where it is easier to
manipulate the state of the random number generator than the
internal state of the dust object.</p><div class="section">
<h4 id="usage-24">Usage<a class="anchor" aria-label="anchor" href="#usage-24"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">set_rng_state</span><span class="op">(</span><span class="va">rng_state</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-10">Arguments<a class="anchor" aria-label="anchor" href="#arguments-10"></a></h4>
<p></p><div class="arguments"><dl><dt><code>rng_state</code></dt>
<dd><p>A random number state, as saved out by the
<code>$rng_state()</code> method. Note that unlike <code>seed</code> as passed to the
constructor, this <em>must</em> be a raw vector of the expected length.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-dust-has_openmp"></a><div class="section">
<h3 id="method-has-openmp-">Method <code>has_openmp()</code><a class="anchor" aria-label="anchor" href="#method-has-openmp-"></a></h3>
<p>Returns a logical, indicating if this model was compiled with
"OpenMP" support, in which case it will react to the <code>n_threads</code>
argument passed to the constructor. This method can also be used
as a static method by running it directly
as <code>dust_generator$public_methods$has_openmp()</code></p><div class="section">
<h4 id="usage-25">Usage<a class="anchor" aria-label="anchor" href="#usage-25"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">has_openmp</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-dust-has_gpu_support"></a><div class="section">
<h3 id="method-has-gpu-support-">Method <code>has_gpu_support()</code><a class="anchor" aria-label="anchor" href="#method-has-gpu-support-"></a></h3>
<p>Returns a logical, indicating if this model was compiled with
"CUDA" support, in which case it will react to the <code>device</code>
argument passed to the run method. This method can also be used
as a static method by running it directly
as <code>dust_generator$public_methods$has_gpu_support()</code></p><div class="section">
<h4 id="usage-26">Usage<a class="anchor" aria-label="anchor" href="#usage-26"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">has_gpu_support</span><span class="op">(</span>fake_gpu <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-11">Arguments<a class="anchor" aria-label="anchor" href="#arguments-11"></a></h4>
<p></p><div class="arguments"><dl><dt><code>fake_gpu</code></dt>
<dd><p>Logical, indicating if we count as <code>TRUE</code>
models that run on the "fake" GPU (i.e., using the GPU
version of the model but running on the CPU)</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-dust-has_compare"></a><div class="section">
<h3 id="method-has-compare-">Method <code>has_compare()</code><a class="anchor" aria-label="anchor" href="#method-has-compare-"></a></h3>
<p>Returns a logical, indicating if this model was compiled with
"compare" support, in which case the <code>set_data</code> and <code>compare_data</code>
methods are available (otherwise these methods will error). This
method can also be used as a static method by running it directly
as <code>dust_generator$public_methods$has_compare()</code></p><div class="section">
<h4 id="usage-27">Usage<a class="anchor" aria-label="anchor" href="#usage-27"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">has_compare</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-dust-real_size"></a><div class="section">
<h3 id="method-real-size-">Method <code>real_size()</code><a class="anchor" aria-label="anchor" href="#method-real-size-"></a></h3>
<p>Return the size of real numbers (in bits). Typically this will be
64 for double precision and 32 for <code>float</code>.  This method can also be
used as a static method by running it directly as
<code>dust_generator$public_methods$real_size()</code></p><div class="section">
<h4 id="usage-28">Usage<a class="anchor" aria-label="anchor" href="#usage-28"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">real_size</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-dust-time_type"></a><div class="section">
<h3 id="method-time-type-">Method <code>time_type()</code><a class="anchor" aria-label="anchor" href="#method-time-type-"></a></h3>
<p>Return the type of time this model uses; will be one of <code>discrete</code>
(for discrete time models) or <code>continuous</code> (for ODE models).
This method can also be used as a static method by running it
directly as <code>dust_generator$public_methods$time_type()</code></p><div class="section">
<h4 id="usage-29">Usage<a class="anchor" aria-label="anchor" href="#usage-29"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">time_type</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-dust-rng_algorithm"></a><div class="section">
<h3 id="method-rng-algorithm-">Method <code>rng_algorithm()</code><a class="anchor" aria-label="anchor" href="#method-rng-algorithm-"></a></h3>
<p>Return the random number algorithm used. Typically this will be
<code>xoshiro256plus</code> for models using double precision reals and
<code>xoshiro128plus</code> for single precision (<code>float</code>). This method can
also be used as a static method by running it directly as
<code>dust_generator$public_methods$rng_algorithm()</code></p><div class="section">
<h4 id="usage-30">Usage<a class="anchor" aria-label="anchor" href="#usage-30"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">rng_algorithm</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-dust-uses_gpu"></a><div class="section">
<h3 id="method-uses-gpu-">Method <code>uses_gpu()</code><a class="anchor" aria-label="anchor" href="#method-uses-gpu-"></a></h3>
<p>Check if the model is running on a GPU</p><div class="section">
<h4 id="usage-31">Usage<a class="anchor" aria-label="anchor" href="#usage-31"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">uses_gpu</span><span class="op">(</span>fake_gpu <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-12">Arguments<a class="anchor" aria-label="anchor" href="#arguments-12"></a></h4>
<p></p><div class="arguments"><dl><dt><code>fake_gpu</code></dt>
<dd><p>Logical, indicating if we count as <code>TRUE</code>
models that run on the "fake" GPU (i.e., using the GPU
version of the model but running on the CPU)</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-dust-n_pars"></a><div class="section">
<h3 id="method-n-pars-">Method <code>n_pars()</code><a class="anchor" aria-label="anchor" href="#method-n-pars-"></a></h3>
<p>Returns the number of distinct pars elements required. This is <code>0</code>
where the object was initialised with <code>pars_multi = FALSE</code> and
an integer otherwise.  For multi-pars dust objects, Where <code>pars</code>
is accepted, you must provide an unnamed list of length <code>$n_pars()</code>.</p><div class="section">
<h4 id="usage-32">Usage<a class="anchor" aria-label="anchor" href="#usage-32"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">n_pars</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-dust-set_n_threads"></a><div class="section">
<h3 id="method-set-n-threads-">Method <code>set_n_threads()</code><a class="anchor" aria-label="anchor" href="#method-set-n-threads-"></a></h3>
<p>Change the number of threads that the dust object will use. Your
model must be compiled with "OpenMP" support for this to have an
effect. Returns (invisibly) the previous value.</p><div class="section">
<h4 id="usage-33">Usage<a class="anchor" aria-label="anchor" href="#usage-33"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">set_n_threads</span><span class="op">(</span><span class="va">n_threads</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-13">Arguments<a class="anchor" aria-label="anchor" href="#arguments-13"></a></h4>
<p></p><div class="arguments"><dl><dt><code>n_threads</code></dt>
<dd><p>The new number of threads to use. You may want to
wrap this argument in <code><a href="dust_openmp_threads.html">dust_openmp_threads()</a></code> in order to
verify that you can actually use the number of threads
requested (based on environment variables and OpenMP support).</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-dust-set_data"></a><div class="section">
<h3 id="method-set-data-">Method <code>set_data()</code><a class="anchor" aria-label="anchor" href="#method-set-data-"></a></h3>
<p>Set "data" into the model for use with the <code>$compare_data()</code> method.
This is not supported by all models, depending on if they define a
<code>data_type</code> type.  See <code><a href="dust_data.html">dust_data()</a></code> for a helper function to
construct suitable data and a description of the required format. You
will probably want to use that here, and definitely if using multiple
parameter sets.</p><div class="section">
<h4 id="usage-34">Usage<a class="anchor" aria-label="anchor" href="#usage-34"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">set_data</span><span class="op">(</span><span class="va">data</span>, shared <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-14">Arguments<a class="anchor" aria-label="anchor" href="#arguments-14"></a></h4>
<p></p><div class="arguments"><dl><dt><code>data</code></dt>
<dd><p>A list of data to set.</p></dd>


<dt><code>shared</code></dt>
<dd><p>Logical, indicating if the data should be shared
across all parameter sets, if your model is initialised to use
more than one parameter set (<code>pars_multi = TRUE</code>).</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-dust-compare_data"></a><div class="section">
<h3 id="method-compare-data-">Method <code>compare_data()</code><a class="anchor" aria-label="anchor" href="#method-compare-data-"></a></h3>
<p>Compare the current model state against the data as set by
<code>set_data</code>. If there is no data set, or no data corresponding to
the current time then <code>NULL</code> is returned. Otherwise a numeric vector
the same length as the number of particles is returned. If model's
underlying <code>compare_data</code> function is stochastic, then each call to
this function may be result in a different answer.</p><div class="section">
<h4 id="usage-35">Usage<a class="anchor" aria-label="anchor" href="#usage-35"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">compare_data</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-dust-filter"></a><div class="section">
<h3 id="method-filter-">Method <code><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter()</a></code><a class="anchor" aria-label="anchor" href="#method-filter-"></a></h3>
<p>Run a particle filter. The interface here will change a lot over the
next few versions. You <em>must</em> reset the dust object using
<code>$update_state(pars = ..., time = ...)</code> before using this method to
get sensible values.</p><div class="section">
<h4 id="usage-36">Usage<a class="anchor" aria-label="anchor" href="#usage-36"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span></span>
<span>  time_end <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  save_trajectories <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  time_snapshot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_log_likelihood <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-15">Arguments<a class="anchor" aria-label="anchor" href="#arguments-15"></a></h4>
<p></p><div class="arguments"><dl><dt><code>time_end</code></dt>
<dd><p>The time to run to. If <code>NULL</code>, run to the end
of the last data.  This value must be larger than the current
model time (<code>$time()</code>) and must exactly appear in the data.</p></dd>


<dt><code>save_trajectories</code></dt>
<dd><p>Logical, indicating if the filtered particle
trajectories should be saved. If <code>TRUE</code> then the <code>trajectories</code> element
will be a multidimensional array (<code>state x &lt;shape&gt; x time</code>)
containing the state values, selected according to the index set
with <code>$set_index()</code>.</p></dd>


<dt><code>time_snapshot</code></dt>
<dd><p>Optional integer vector indicating times
that we should record a snapshot of the full particle filter state.
If given it must be strictly increasing vector whose elements
match times given in the <code>data</code> object. The return value with be
a multidimensional array (<code>state x &lt;shape&gt; x time_snapshot</code>)
containing full state values at the requested times.</p></dd>


<dt><code>min_log_likelihood</code></dt>
<dd><p>Optionally, a numeric value representing
the smallest likelihood we are interested in. If non-<code>NULL</code>
either a scalar value or vector the same length as the number
of parameter sets. Not yet supported, and included for future
compatibility.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-dust-gpu_info"></a><div class="section">
<h3 id="method-gpu-info-">Method <code>gpu_info()</code><a class="anchor" aria-label="anchor" href="#method-gpu-info-"></a></h3>
<p>Return information about GPU devices, if the model
has been compiled with CUDA/GPU support. This can be called as a
static method by running <code>dust_generator$public_methods$gpu_info()</code>.
If run from a GPU enabled object, it will also have an element
<code>config</code> containing the computed device configuration: the device
id, shared memory and the block size for the <code>run</code> method on the
device.</p><div class="section">
<h4 id="usage-37">Usage<a class="anchor" aria-label="anchor" href="#usage-37"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">dust_generator</span><span class="op">$</span><span class="fu">gpu_info</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div>

    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># An example dust object from the package:</span></span></span>
<span class="r-in"><span><span class="va">walk</span> <span class="op">&lt;-</span> <span class="fu">dust</span><span class="fu">::</span><span class="fu"><a href="dust_example.html">dust_example</a></span><span class="op">(</span><span class="st">"walk"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The generator object has class "dust_generator"</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">walk</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dust_generator"   "R6ClassGenerator"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The methods below are are described in the documentation</span></span></span>
<span class="r-in"><span><span class="va">walk</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;dust&gt; object generator</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Public:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     initialize: function (pars, time, n_particles, n_threads = 1L, seed = NULL, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     name: function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     param: function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     run: function (time_end) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     simulate: function (time_end) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     run_adjoint: function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     set_index: function (index) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     index: function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ode_control: function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ode_statistics: function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     n_threads: function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     n_state: function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     n_particles: function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     n_particles_each: function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     shape: function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     update_state: function (pars = NULL, state = NULL, time = NULL, set_initial_state = NULL, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     state: function (index = NULL) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     time: function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     set_stochastic_schedule: function (time) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     reorder: function (index) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     resample: function (weights) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     info: function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pars: function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     rng_state: function (first_only = FALSE, last_only = FALSE) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     set_rng_state: function (rng_state) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     has_openmp: function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     has_gpu_support: function (fake_gpu = FALSE) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     has_compare: function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     real_size: function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     time_type: function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     rng_algorithm: function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     uses_gpu: function (fake_gpu = FALSE) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     n_pars: function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     set_n_threads: function (n_threads) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     set_data: function (data, shared = FALSE) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     compare_data: function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     filter: function (time_end = NULL, save_trajectories = FALSE, time_snapshot = NULL, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     gpu_info: function () </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Private:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pars_: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pars_multi_: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     index_: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     info_: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     n_threads_: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     n_particles_: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     n_particles_each_: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     shape_: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ptr_: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     gpu_config_: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ode_control_: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     methods_: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     param_: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     reload_: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Parent env: &lt;environment: namespace:dust&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Locked objects: TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Locked class: FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Portable: TRUE</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Rich FitzJohn, Alex Hill, John Lees.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

